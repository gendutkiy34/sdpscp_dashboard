SELECT to_char(TIMESTAMP,'dd-mm-yyyy') CDR_DATE,to_char(TIMESTAMP,'HH24:MI') CDR_HOUR
,SUM(CASE WHEN ACCESSFLAG='66' THEN 1 ELSE 0 END) AS bmo_att
,SUM(CASE WHEN ACCESSFLAG='66' AND INTERNALCAUSE IN ('2001','4010','4012','5030','5031') THEN 1 ELSE 0 END) AS bmo_suc
,SUM(CASE WHEN ACCESSFLAG='67' THEN 1 ELSE 0 END) AS bmt_att
,SUM(CASE WHEN ACCESSFLAG='67' AND INTERNALCAUSE IN ('2001','4010','4012','5030','5031') THEN 1 ELSE 0 END) AS bmt_suc
,SUM(CASE WHEN ACCESSFLAG='68' THEN 1 ELSE 0 END) AS dig_att
,SUM(CASE WHEN ACCESSFLAG='68' AND INTERNALCAUSE IN ('2001','4010','4012','5030','5031') THEN 1 ELSE 0 END) AS dig_suc
,SUM(CASE WHEN ACCESSFLAG='72' THEN 1 ELSE 0 END) AS smo_att
,SUM(CASE WHEN ACCESSFLAG='72' AND INTERNALCAUSE IN ('2001','4010','4012','5030','5031') THEN 1 ELSE 0 END) AS smo_suc
,SUM(CASE WHEN ACCESSFLAG='73' THEN 1 ELSE 0 END) AS smt_att
,SUM(CASE WHEN ACCESSFLAG='73' AND INTERNALCAUSE IN ('2001','4010','4012','5030','5031') THEN 1 ELSE 0 END) AS smt_suc
,SUM(CASE WHEN ACCESSFLAG='8' THEN 1 ELSE 0 END) AS rnw_att
,SUM(CASE WHEN ACCESSFLAG='8' AND INTERNALCAUSE IN ('2001','4010','4012','5030','5031') THEN 1 ELSE 0 END) AS rnw_suc
from scmcdr.scm_cc_{mon} 
where m_day='{day}' AND to_char(TIMESTAMP,'HH24:MI') >= '{min1}' AND to_char(TIMESTAMP,'HH24:MI') < '{min2}'
GROUP BY to_char(TIMESTAMP,'dd-mm-yyyy'),to_char(TIMESTAMP,'HH24:MI')
ORDER BY to_char(TIMESTAMP,'HH24:MI')